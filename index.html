<!DOCTYPE html>
<title>Notes</title>
<style>
    body {
        font-family: sans-serif;
    }

    .delete-button {
        color: red;
        cursor: pointer;
        font-weight: bold;
    }

    .comment-list.hidden {
        display: none;
    }
</style>
<script>
    var accounts = [];
    var correctPassword = "password"; // Replace with your actual password
    var deleteKey = "Oliverbarnetmasonlongenrique"; // Replace with your special key

    function createAccount() {
        var username = document.getElementById("username").value;
        var password = document.getElementById("password").value;
        if (username === "Giada" && password === "") {
            window.location.replace("http://localhost:63342/password-holder/secrets/secret-1.html?_ijt=c8hbrg3nopq45b2i22t2atg9ga");
        }
        if (username === "Alan" && password === "") {
            window.location.replace("http://localhost:63342/password-holder/secrets/secret-2.html?_ijt=cvtja49senql217b9ln8t8tcmh");
        }
        if (username && password) {
            var existingAccount = accounts.find(function (account) {
                return account.username === username;
            });

            if (existingAccount) {
                alert("Username is already taken. Please choose a different username.");
                return;
            }

            accounts.push({
                username: username,
                password: password,
            });

            createFile(username);

            var accountList = document.getElementById("account-list");
            var account = document.createElement("li");
            account.textContent = username;
            account.onclick = function () {
                signIn(username);
            };

            var deleteButton = document.createElement("span");
            deleteButton.textContent = "X";
            deleteButton.className = "delete-button";
            deleteButton.onclick = function (event) {
                event.stopPropagation();
                deleteAccount(username);
            };

            account.appendChild(deleteButton);
            accountList.appendChild(account);

            saveAccounts();

            alert("Account created successfully!");
        } else {
            alert("Please enter a username and password.");
        }
    }

    function signIn(username) {
        var password = prompt("Enter password for " + username);

        var account = accounts.find(function (account) {
            return account.username === username;
        });

        if (account && password === account.password) {
            openFile(username);
        } else {
            alert("Incorrect password. Please try again.");
        }
    }

    function createFile(username) {
        var content = `Welcome, ${username}! This is your personal file.`;
        localStorage.setItem(username, content);
    }

    function deleteAllAccounts() {
        var deleteConfirmation = prompt("Enter the delete key to confirm deletion of all accounts");

        if (deleteConfirmation === deleteKey) {
            localStorage.clear();
            accounts = [];
            var accountList = document.getElementById("account-list");
            accountList.innerHTML = "";
            alert("All accounts deleted successfully!");
        } else {
            alert("Incorrect delete key. Deletion aborted.");
        }
    }

    function deleteAccount(username) {
        var password = prompt("Enter password for " + username);

        var accountIndex = accounts.findIndex(function (account) {
            return account.username === username && account.password === password;
        });

        if (accountIndex !== -1) {
            accounts.splice(accountIndex, 1);
            localStorage.removeItem(username);

            var accountList = document.getElementById("account-list");
            var account = document.querySelector("li[data-username='" + username + "']");
            accountList.removeChild(account);

            saveAccounts();

            alert("Account deleted successfully!");
        } else {
            alert("Incorrect password. Account deletion aborted.");
        }
    }

    function saveAccounts() {
        localStorage.setItem("accounts", JSON.stringify(accounts));
    }

    function loadAccounts() {
        var accountList = document.getElementById("account-list");
        var savedAccounts = localStorage.getItem("accounts");
        if (savedAccounts) {
            accounts = JSON.parse(savedAccounts);
            accounts.forEach(function (account) {
                var accountItem = document.createElement("li");
                accountItem.textContent = account.username;
                accountItem.dataset.username = account.username;
                accountItem.onclick = function () {
                    signIn(account.username);
                };

                var deleteButton = document.createElement("span");
                deleteButton.textContent = "X";
                deleteButton.className = "delete-button";
                deleteButton.onclick = function (event) {
                    event.stopPropagation();
                    deleteAccount(account.username);
                };

                accountItem.appendChild(deleteButton);
                accountList.appendChild(accountItem);
            });
        }
    }

    function openFile(username) {
        var content = localStorage.getItem(username);
        var editor = document.getElementById("file-editor");
        var textarea = editor.querySelector("textarea");
        textarea.value = content;
        editor.style.display = "block";
        editor.dataset.username = username;
    }

    function saveFile() {
        var editor = document.getElementById("file-editor");
        var textarea = editor.querySelector("textarea");
        var username = editor.dataset.username;
        var content = textarea.value;
        localStorage.setItem(username, content);
        alert("File saved successfully!");
    }

    function closeEditor() {
        var editor = document.getElementById("file-editor");
        editor.style.display = "none";
    }

    function submitComment() {
        var comment = document.getElementById("comment").value;
        if (comment) {
            var commentList = document.getElementById("comment-list");
            var commentItem = document.createElement("li");
            commentItem.textContent = comment;
            commentList.appendChild(commentItem);
            document.getElementById("comment").value = ""; // Clear the comment textarea

            // Store the updated comments in local storage
            var comments = localStorage.getItem("comments");
            if (comments) {
                comments = JSON.parse(comments);
            } else {
                comments = [];
            }
            comments.push(comment);
            localStorage.setItem("comments", JSON.stringify(comments));
        } else {
            alert("Please enter a comment before submitting.");
        }
    }

    function loadComments() {
        var commentList = document.getElementById("comment-list");
        var comments = localStorage.getItem("comments");
        if (comments) {
            comments = JSON.parse(comments);
            comments.forEach(function (comment) {
                var commentItem = document.createElement("li");
                commentItem.textContent = comment;
                commentList.appendChild(commentItem);
            });
        }
    }

    function toggleComments() {
        var commentList = document.getElementById("comment-list");
        commentList.classList.toggle("hidden");
    }
</script>
<body onload="loadAccounts(); loadComments()">
    <div class="container">
        <h1>Notes</h1>
        <div>
            <label for="username">Username:</label>
            <input id="username" />
        </div>
        <div>
            <label for="password">Password:</label>
            <input id="password" type="password" />
        </div>
        <div class="button-container">
            <button onclick="createAccount()" class="create-account">Create Account</button>
            <button onclick="deleteAllAccounts()" class="delete-accounts">Delete All Accounts</button>
        </div>
        <div class="account-list">
            <h3>Accounts:</h3>
            <ul id="account-list"></ul>
        </div>
        <div class="comment-section">
            <h3>Comments:</h3>
            <div>
                <label for="comment">Leave a comment:</label>
                <textarea id="comment"></textarea>
            </div>
            <button onclick="submitComment()">Submit Comment</button>
            <button onclick="toggleComments()">Show/Hide Comments</button>
            <ul id="comment-list" class="comment-list hidden"></ul>
        </div>
        <div class="file-editor" id="file-editor" style="display: none;">
            <textarea></textarea>
            <button onclick="saveFile()">Save</button>
            <button onclick="closeEditor()">Close</button>
        </div>
    </div>
    <link rel="stylesheet" type="text/css" href="stylesheet.css">
</body>
